<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-document.html">
<link rel="import" href="../../bower_components/iron-media-query/iron-media-query.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">

<!-- custom elements -->
<link rel="import" href="emsi-button.html">
<link rel="import" href="emsi-firebase-document.html">
<link rel="import" href="emsi-homepage-picture.html">
<link rel="import" href="emsi-church-description.html">
<link rel="import" href="emsi-church-ministries-fellowships.html">
<link rel="import" href="emsi-church-pastors-staff.html">
<link rel="import" href="emsi-church-news.html">
<link rel="import" href="emsi-church-events.html">


<dom-module id="emsi-church-page">
	<template>
		<style>
			:host {
				display: block;
				min-height: 100vh;
				width: 100%;
				z-index: 0;
				background-color: #857874;
			}

			@font-face {
			    font-family: MyriadProBold;
			    src: url(https://github.com/huawillian/emsi/raw/master/src/fonts/MyriadPro-Bold.otf);
			}

			@font-face {
			    font-family: MyriadProRegular;
			    src: url(../fonts/MyriadPro-Regular.otf);
			}

			@font-face {
			    font-family: MyriadProSemibold;
			    src: url(../fonts/MyriadPro-Semibold.otf);
			}

			#churchHeader {
				background-color: rgba(255,255,255, 0.8);
				text-align: center;
				padding-bottom: 10vh;
			}

			#churchName {
				font-family: MyriadProBold;
				font-size: 40pt;
				color: #236192;
				padding-top: 10vh;
				margin-right: 10%;
				margin-left:  10%;
			}

			#churchAddress {
				font-family: MyriadProSemibold;
				font-size: 20pt;
				color: rgba(0,0,0,0.6);
				padding-bottom: 5px;
				margin-right: 5%;
				margin-left: 5%;
			}

			#churchPhoneNumber, #churchEmail {
				font-size: 18pt;
				color: rgba(0,0,0,0.5);
				font-family: MyriadProRegular;
				text-align: center;
				padding-bottom: 30px;
				margin-right: 15pt;
				margin-left: 15pt;
			}

			#serviceContainer {
				font-size: 13pt;
				color: rgba(0,0,0,0.6);
				font-family: MyriadProRegular;
				width: 400px;
				text-align: left;
				padding-bottom: 30px;
				margin-left:auto; 
    			margin-right:auto;
    			padding-left: 60px;
			}

			#serviceTitle {
				font-size: 16pt;
				color: rgba(0,0,0,0.6);
				font-family: MyriadProBold;
				padding-top: 30px;
				padding-bottom: 5px;
			}

			paper-button {
				font-family: MyriadProRegular;
				background-color: #236192;
				color: white;
				border: 2px solid white;
				border-radius: 5px;
				font-size: 14pt;
				padding: 15px 40px 15px 40px;
				width:50%;
				margin-left: 2%;
				margin-bottom: 5vh;
				display: inline;
			}

			#contentArea {
		        padding: 0;
		        margin: 0;
		        width: 100%;
		        @apply(--layout-horizontal);
		        @apply(--layout-wrap);
		    }

		    emsi-button {
		    	display: inline;
		    }

		    emsi-button ::content paper-button {
		    	width:20vw;
		    }

		    @media screen and (max-width: 800px) {
				emsi-button ::content paper-button {
			    	width:80vw;
			    	margin-top: 10pt;
			    }
			}

		</style>

	    <firebase-document
	      path= "locations"
	      data="{{data}}">
	    </firebase-document>

		<div id="churchHeader">
			<div id="churchName"> {{churchData.name}} </div>
			<div id="churchAddress"> {{churchData.address}} </div>
			<div>
				<span id="churchPhoneNumber"> {{churchData.phone}} </span>
				<span id="churchEmail"> {{churchData.email}} </span>
			</div>
			<div id="serviceTitle"> Sunday Worship Times </div>
			<table id="serviceContainer">
				<template is="dom-repeat" items="[[churchData.time]]">
					<tr>
						<td>{{item.time}}</td> 
					    <td>{{item.name}}</td>
				  	</tr>
				</template>
			</table>
			
			<emsi-button color="brown" on-tap="goToGoogleMaps">
				<emsi-firebase-document my-path="getDirectionsButton" lang="{{lang}}" display> </emsi-firebase-document> 
			</emsi-button>
			<emsi-button color="brown" on-tap="openEmail">
				<emsi-firebase-document my-path="home/contactButton" lang="{{lang}}" display> </emsi-firebase-document> 
			</emsi-button>
		</div>

		<iron-media-query query="(min-width: 800px)" query-matches="{{isTwoColumns}}"></iron-media-query>

		<div id="contentArea">
			<!-- If large screen, show this... -->
			<template is="dom-if" if="[[isTwoColumns]]">
				<emsi-homepage-picture image-url="{{churchData.churchImageUrl}}"> </emsi-homepage-picture>
				<emsi-church-ministries-fellowships title="Ministries and Fellowships" data="{{churchData.ministries}}"> </emsi-church-ministries-fellowships>
				<emsi-church-events title="Upcoming Events" data="{{churchData.events}}"> </emsi-church-events>
				<emsi-church-pastors-staff title="Pastors and Staff" data="{{churchData.staff}}"> </emsi-church-pastors-staff>
				<emsi-church-description title="Brief History" description="{{churchData.description}}"> </emsi-church-description>
				<emsi-church-news title="News and Updates" data="{{churchData.news}}"> </emsi-church-news>
			</template>

			<!-- If small screen, show this... -->
			<template is="dom-if" if="[[!isTwoColumns]]">
				<emsi-homepage-picture image-url="{{churchData.churchImageUrl}}"> </emsi-homepage-picture>
				<emsi-church-ministries-fellowships title="Ministries and Fellowships" data="{{churchData.ministries}}"> </emsi-church-ministries-fellowships>
					<emsi-church-pastors-staff title="Pastors and Staff" data="{{churchData.staff}}"> </emsi-church-pastors-staff>
					<emsi-church-events title="Upcoming Events" data="{{churchData.events}}"> </emsi-church-events>
					<emsi-church-description title="Brief History" description="{{churchData.description}}"> </emsi-church-description>
					<emsi-church-news title="News and Updates" data="{{churchData.news}}"> </emsi-church-news>
			</template>
		</div>



		
	</template>
	<script>
		Polymer({
			is: 'emsi-church-page' ,

			properties: {
				path: {
					type: String,
					value: "church/chinatown",
					observer: "pathChanged"
				} ,
				lang: String,
				data: {
					type: Object,
					value: {},
					observer: "dataChanged"
				} ,
				churchData: {
					type: Object,
					value: {},
				}
			} ,

			pathChanged: function(newValue, oldValue) {
				if(oldValue == undefined) return;

				console.log(newValue);

				for(var key in this.data) {

					if(this.data[key].url == newValue) {
						this.churchData = this.data[key];
					}
				}
			} ,

			dataChanged: function(newValue, oldValue) {
				if(oldValue == undefined) return;
				if(newValue == {}) return;

				console.log(this.path);

				for(var key in newValue) {

					if(newValue[key].url == this.path) {
						this.churchData = newValue[key];
					}
				}
			} ,

			goToGoogleMaps: function() {
				setTimeout(function(){
					window.open('http://maps.google.com/?q=' + this.churchData.address);
				}.bind(this), 0);
			} ,

			openEmail: function() {
				window.open('mailto:' + this.churchData.email);
			}
		});
	</script>
</dom-module>