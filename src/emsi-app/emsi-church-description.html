<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="../../bower_components/neon-animation/web-animations.html">

<dom-module id="emsi-church-description">
	<template>
		<style>
			:host {
				display: block;
				margin: 0;
				padding: 0;
				margin-bottom: -4pt;
				background-color: white;
			}

			.container {
				width:100%;
				height: 50vw;
				background-color: rgba(133,120,116, 0.9);
			}

			.title {
				color: #236192;
				font-weight: 700;
				font-size: 25pt;
				font-family: MyriadProBold;
				letter-spacing: 0px;
				color: white;
				margin-bottom: 15pt;
			}

			.content {
				color: white;
				font-weight: 400;
				font-size: 15pt;
				line-height: 1.5;
				font-family: MyriadProRegular;
				margin-bottom: 15pt;
			}

			.container > table {
				width:100%; 
				height:100%; 
				text-align: left; 
				padding: 15%;
			}

			@media screen and (max-width: 800px) {
				.container {
					height:100vw
				}
			}

			@media screen and (max-width: 1000px) and (min-width: 800px) {
				.container > table {
					padding: 10%;
				}

				.title {
					font-size: 30px;
					margin-bottom: 8pt;
				}

				.content {
					margin-bottom: 8pt;
					font-size: 13pt;
				}
			}


			@media screen and (max-width: 800px) and (min-width: 500px){
				.container > table {
					padding: 15%;
				}

				.title {
					font-size: 25pt;
					margin-bottom: 15pt;
				}

				.content {
					font-size: 15pt;
					margin-bottom: 15pt;
				}
			}

			@media screen and (max-width: 500px) {
				.container > table {
					padding: 7%;
				}

				.title {
					font-size: 30px;
					margin-bottom: 8pt;
				}

				.content {
					margin-bottom: 8pt;
					font-size: 13pt;
				}
			}

			paper-dialog {
				width: 80%;
				background-color: white;
			}

		</style>

		<div class="container">
			<table> 
				<tbody valign="top">
					<tr>
	    				<td>
	    					<div class="title"> {{title}} </div>
	    					<div class="content">  </div>
	    					<template is="dom-if" if="{{hasHiddenDescription}}">
						      <emsi-button color="blue" on-tap="showMore">
										<template is="dom-if" if="[[isEnglish]]">
											SHOW MORE
										</template>
										<template is="dom-if" if="[[!isEnglish]]">
											? CHINESE SHOW ?
										</template>
									</emsi-button>
						    </template>
	    				</td>
	    			</tr>
    			</tbody>
			</table>
		</div>

		<paper-dialog id="dialog" modal style="width: 80vw; padding: 20pt; padding-right: 0">
		  <div style="color: #236192; font-size: 22pt; font-family: MyriadProBold;"> {{title}} </div>
		  <paper-dialog-scrollable>
			<div class="content contentDialog" style="color: rgba(0,0,0,0.6); font-size: 12pt; line-height: 1.5; font-family: MyriadProRegular;overflow-y: scroll;height:60vh;padding:5pt">
			</div>
		  </paper-dialog-scrollable>
		  <div class="buttons" style="margin-top: 20pt">
		    <emsi-button color="blue" dialog-dismiss> CLOSE </emsi-button>
		  </div>
		</paper-dialog>

	</template>

	<script>
		class EMSIChurchDescription extends Polymer.Element {
			static get is() { return 'emsi-church-description'; }

			static get properties() { 
				return {
					lang: {
						type: String,
						value: "en"
					},
					title: String,
					description: {
						type: String,
						observer: "descriptionChanged"
					} ,
					displayedDescription: String,
					hasHiddenDescription: Boolean,
				}; 
			}

			static get observers() { return [ 'languageChanged(lang)' ]; }

      languageChanged(val) { this.isEnglish = val === "en"; }

			descriptionChanged(newValue, oldValue) {
				var polymerElem = Polymer.dom(this.root).querySelector(".content");
				var polymerElemDialog = Polymer.dom(this.root).querySelector(".contentDialog");

				this.displayedDescription = newValue.slice(0, 300);

				if(newValue.length > 300) {
					this.displayedDescription += " . . .";
					this.hasHiddenDescription = true;
				} else {
					this.hasHiddenDescription = false;
				}

				Polymer.dom(polymerElem).node.innerHTML = this.displayedDescription;
				Polymer.dom(polymerElemDialog).node.innerHTML = this.description;
			}

			showMore() {
				var body = document.querySelector('body');
			  	Polymer.dom(body).appendChild(this.$.dialog);
			  	this.$.dialog.open();
			}
		}

		window.customElements.define(EMSIChurchDescription.is, EMSIChurchDescription);
	</script>
</dom-module>